"use strict";(self.modernJsonp=self.modernJsonp||[]).push([[53984,33166],{892700:(e,n,a)=>{a.d(n,{$K:()=>i,dh:()=>o,ry:()=>t,xX:()=>s});let o=e=>/instagram/i.test(e||""),t=e=>o(e)||/facebook/i.test(e||"")||/line/i.test(e||"")||/wechat/i.test(e||""),l="[Pinterest/Android]",i=e=>(e||"").includes("[Pinterest/iOS]")||(e||"").includes(l),s=e=>(e||"").includes(l)},575481:(e,n,a)=>{a.d(n,{J:()=>l,U:()=>m});var o=a(578373),t=a(992114);let l="nic_v4",i=`${l}=1a`,s=`${l}=1b`,u=[i,s],_=["invite_code","invite","board_invite_code","sender"],r=null,d=e=>!!_.find(n=>e.includes(n)),p=e=>{let n;return e.pathname.includes("/pin/")&&!d(e.search)&&(n=e.search,!u.find(e=>n.includes(e)))},c=async e=>{let{resource_response:n}=await o.Z.create("InviteSocialTrackingParamNonInviteResource",{user_id:e}).callCreate();if(!n)return(0,t.nP)(`${l}.social_tracking_pin_non_invite.no_resource_response`),"";{let e=encodeURIComponent(n.data);return(0,t.nP)(`${l}.social_tracking_pin_non_invite.encrypted.${e?"true":"false"}`),e}},S=(e,n,a=!1,o)=>{if(!p(e))return;let u=a?"mweb":"web";if(!n)return void(0,t.nP)(`${u}.${l}.social_tracking_pin_non_invite.insert.no_encrypted_id`);(0,t.nP)(`${u}.${l}.social_tracking_pin_non_invite.insert.attempt`);try{let _=((e,n,a)=>{let o=e.search?"&":"?";return e.pathname+e.search+(o+(a?s:i)+n)})(e,n,a||!1);(0,t.nP)(`${u}.${l}.social_tracking_pin_non_invite.insert.success`),o(_)}catch{(0,t.nP)(`${u}.${l}.social_tracking_pin_non_invite.insert.caught_exception`)}},m=(e,n,a,o,i)=>{let s=a?"mweb":"web";(0,t.nP)(`${s}.${l}.social_tracking_pin_non_invite.attempt`);try{let u;!a&&o&&p(e)?((0,t.nP)(`${s}.${l}.social_tracking_pin_non_invite.search_string_eligible`),((e,n,a=!1,o)=>{r?S(e,r,a,o):(async()=>{let t=await c(n);r=t,S(e,t,a,o)})()})(e,n,a,i)):(u=e.search,!d(u)&&!u.includes("sender")&&u.includes(l)&&(0,t.nP)(`${s}.${l}.social_tracking_pin_non_invite.search_string_land`))}catch{(0,t.nP)(`${s}.${l}.social_tracking_pin_non_invite.caught_exception`)}}},489384:(e,n,a)=>{a.d(n,{Z:()=>d});var o=a(825332),t=a(575481),l=a(890360),i=a(174646),s=a(177270),u=a(180307),_=a(839284),r=a(992114);function d(){let e,{isBot:n,isSocialBot:a,referrerFromCookie:d,referrerFromHeader:p,countryFromHostName:c,countryFromIp:S,regionFromIp:m,isAuthenticated:g}=(0,i.B)(),h=(0,o.TH)(),b=(0,_.Z)(),w=new URLSearchParams(h.search),y=!n&&!!w.get("utm_pai"),L=w.get("utm_source"),I=!n&&!a&&(0,l.ey)(h),E=(0,u.Z)({countryFromHostName:c||"",countryFromIp:S||"",regionFromIp:m||"",isAuthenticated:g}),O=p||E&&d||"";e=b||!E?O:(0,s.an)(O);let C=!1,N=!n&&!a&&L&&["email",String(31)].includes(L),P=!n&&!a&&L&&["fb"].includes(L),v=!n&&!a&&"offsite"===L,U=!n&&!a&&!!(e&&(/facebook/.test(e)||/fb/.test(e))),M=!n&&!a&&!!(e&&(/twitter/.test(e)||/tw/.test(e)));I&&(0,r.nP)("unauth.entry_channel.invite_code",{sampleRate:1}),N&&(0,r.nP)("unauth.entry_channel.email_utm_source",{sampleRate:1}),P&&(0,r.nP)("unauth.entry_channel.social_media_utm_source_fb",{sampleRate:1}),v&&(0,r.nP)("unauth.entry_channel.offsite_utm_source",{sampleRate:1}),U&&(0,r.nP)("unauth.entry_channel.social_media_referer_fb",{sampleRate:1}),M&&(0,r.nP)("unauth.entry_channel.social_media_referer_twitter",{sampleRate:1}),C=(0,s.Xn)(e);let T=!n&&C,k=!!w.get(t.J),f=!!w.get("twa_type")||e&&e.startsWith("android-app://com.pinterest.twa"),R=["utm_source","utm_medium","utm_campaign","utm_term","utm_content","utm_admin","utm_id","utm_mail","utm_swu"].some(e=>null!==w.get(e))||!!e||k||f;return{isPaid:y,isInvite:I,utmSource:L,referrer:e,isSocial:I,isDirect:!n&&!y&&!I&&!T&&!R,isSEO:T,isBrowserStorageAllowed:E,isOffsite:v}}},177270:(e,n,a)=>{a.d(n,{Xn:()=>m,Yf:()=>w,an:()=>g});var o=a(890360),t=a(50113),l=a(857147);let i="BING",s="GOOGLE",u="YAHOO",_="YANDEX",r="RAKUTEN",d="NAVER",p="AMP_CACHE",c="DUCKDUCKGO",S=[s,i,u,_,r,d,p,c];function m(e){return S.includes(function(e){let{hostname:n}=(0,l.Qc)(e,!0);if(n&&e){if(n.includes("google.")||e.includes("android-app://com.google.android.googlequicksearchbox"))return s;else if(n.includes("bing."))return i;else if(n.includes("yahoo."))return u;else if(n.includes("yandex."))return _;else if(n.includes("rakuten."))return r;else if(n.includes("naver."))return d;else if(n.includes("duckduckgo."))return c;else if(n.includes(".cdn.ampproject.org"))return p}return""}(e))}function g(e){return e||"undefined"!=typeof document&&document.referrer||""}let h=e=>"/"!==e[e.length-1]?`${e}/`:e,b=e=>{let n=h(e),a=(0,o.ll)({url:n});if((0,o.L6)(a))return"PIN";if((0,o.am)(a))return"BOARD";if((0,t.Z)(a))return"PROFILE";if((0,o.bo)(a))return"TODAY";if((0,o.z_)(a))return"IDEA";else if((0,o.R$)(a))return"SHOPPING";return"UNKNOWN"},w=({country:e,language:n,isBot:a,hostname:o,pathname:t})=>({domain:o,country:e,language:n,currentUrl:t,pageType:b(t),referrer:document.referrer,isBot:a,links:(({selector:e,skipExternal:n})=>{let a=Array.from(document.querySelectorAll(e)),o={pin:[],board:[],user:[],today:[],idea:[],shopping:[]},t=new Set;return a.forEach(e=>{let a=e.getAttribute("href");if(!a||a.startsWith("#")||n&&a.startsWith("http")&&!a.includes(window.location.hostname))return;let l=h(a);if(t.has(l))return;t.add(l);let i=b(l);"PIN"===i?o.pin.push(l):"BOARD"===i?o.board.push(l):"PROFILE"===i?o.user.push(l):"TODAY"===i?o.today.push(l):"IDEA"===i?o.idea.push(l):"SHOPPING"===i&&o.shopping.push(l)}),o})({selector:"a[href]",skipExternal:!0})})},955696:(e,n,a)=>{a.d(n,{HZ:()=>S,ZP:()=>E,e_:()=>I,pT:()=>h});var o=a(667294),t=a(545007),l=a(838380),i=a(892700),s=a(489384),u=a(174646),_=a(756493),r=a(541105),d=a(559825),p=a(992114);let c=()=>(0,t.v9)(e=>e.upsell?.mWebSignupModal.modal.isShown??!1),S=()=>(0,t.v9)(e=>e.upsell?.modal),m=()=>(0,t.v9)(e=>e.upsell?.mWebSignupModal.isUnauthSharingModalsShown??!1),g=()=>(0,t.v9)(e=>!!e.upsell?.mWebSignupModal.modalHasShown),h=()=>(0,t.v9)(e=>e.upsell?.mWebSignupModal),b=()=>{let e=(0,u.B)(),n=(0,s.Z)();return(0,o.useMemo)(()=>(0,r.T9)(e,n),[e,n])},w=Object.freeze(["CO","ID"]),y=e=>w.includes(e),L=e=>{if(!(0,i.dh)(e))return!1;let n=(0,_.Nl)();return n.getItem(l.QV)||((0,p.nP)("mobile_signup_modal.rules.suppress_for_instagram_in_app_browser"),n.setItem(l.QV,"1")),!0},I=({isModalShown:e,isUnauthSharingModalsShown:n,modalHasShown:a,country:o,userAgent:t})=>!e&&!(n||a&&y(o)||(0,d.P)()||L(t));function E(){let e=c(),n=(0,t.v9)(e=>e.upsell?.mWebSignupModal.modal),a=(0,t.v9)(e=>e.upsell?.mWebSignupModal.upsellEligibleNavigationCount),l=m(),i=g();return{isModalShown:e,modal:n,upsellEligibleNavigationCount:a,isUnauthSharingModalsShown:l,modalHasShown:i,sessionContext:b(),isUpsellEnabledGlobally:(()=>{let e=c(),n=m(),a=g(),t=b();return(0,o.useCallback)(()=>!e&&!(({isUnauthSharingModalsShown:e,modalHasShown:n,sessionContext:a})=>{if(!a)return!1;let{country:o,userAgent:t}=a;return e||n&&y(o)||(0,d.P)()||L(t)})({isUnauthSharingModalsShown:n,modalHasShown:a,sessionContext:t}),[e,n,a,t])})()}}},103787:(e,n,a)=>{a.d(n,{Gk:()=>l,YM:()=>s,ZW:()=>i});var o=a(890360),t=a(50113);let l={shouldShowCloseupNavigationalModal:{id:"closeup_navigational_modal_trigger",evaluate:({pinViewCount:e,navigationalPagesUpsellSeen:n})=>(e??0)>=4&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"navigation_1",container:"closeup",reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})},shouldShowSaveModal:{id:"save_modal_trigger",evaluate:()=>!0,getNextState:({action:e,state:n})=>({...n,pinSaveCount:n.pinSaveCount+1,pinId:e.payload.pinId,attributionLabel:e.payload.attributionLabel,showSaveModal:!0,modal:{isShown:!0,displayProps:{attributionLabel:e.payload.attributionLabel,container:"save",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",savePinId:e.payload.pinId,signupFlow:{type:"signup"},source:"saveButtonExp"}}})},shouldShowNavigationalModal:{id:"desktop_navigational_modal_trigger",evaluate:({uniqueNavigationalPagesSeen:e=[],navigationalPagesUpsellSeen:n,navigationalPagesViewThresholdDesktop:a})=>e.length>=(a??4)&&!n,getNextState:({state:e,action:n})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:`navigation_${n.payload.containerPage}`,container:n.payload.containerPage,reason:"UPSELL_LOGIN_OR_SIGNUP"}},navigationalPagesUpsellSeen:!0})},shouldShowSignupModalOnCloseUpClick:{id:"closeup_modal_trigger",evaluate:({modal:e,clickCloseUp:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_closeup",container:"pinWash",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickCloseUp:!0})},shouldShowSignupModalOnClickContextMenuSaveButton:{id:"context_menu_save_button_trigger",evaluate:({modal:e,clickContextMenuSaveButton:n})=>!e?.isShown&&!n,getNextState:({action:e,state:n})=>{let a;return a=["enabled_all_improved","enabled_all","enabled_save"].includes(e.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===e.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:e.payload.pinId},{...n,modal:{isShown:!0,displayProps:a},clickContextMenuSaveButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}},shouldShowSignupModalOnClickCloseupSaveButton:{id:"closeup_save_button_trigger",evaluate:({modal:e,clickCloseUpContextMenuSaveButton:n})=>!e?.isShown&&!n,getNextState:({action:e,state:n})=>{let a;return a=["enabled_all_improved","enabled_all","enabled_save"].includes(e.payload.signupToLoginExpGroup)?{signupFlow:{type:"login"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"enabled_all_improved"===e.payload.signupToLoginExpGroup?"saveButton":"defaultSource"}:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_save_button`,container:"save",reason:"UPSELL_LOGIN_OR_SIGNUP",source:"saveButtonExp",savePinId:e.payload.pinId},{...n,modal:{isShown:!0,displayProps:a},clickCloseUpContextMenuSaveButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}},shouldShowSignupModalOnContextMenuDownloadClick:{id:"desktop_context_menu_download_button_trigger",evaluate:({limitReached:e,inImmediateUpsellGroup:n,modal:a})=>!!((e||n)&&!a?.isShown),getNextState:({action:e,state:n})=>{let a;return a=e.payload.inDwebSwapDownloadUpsellExp?{signupFlow:{type:"login"},attributionLabel:`click_${e.payload.attributionLabelSource}_download_button`,container:"lopDownloadUpsell",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"lopDownloadUpsell"}:{signupFlow:{type:"signup"},attributionLabel:`click_${e.payload.attributionLabelSource}_download_button`,container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:e.payload.pinId},{...n,modal:{isShown:!0,displayProps:a},clickContextMenuDownloadButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource}}},shouldShowSignupModalOnCloseupDownloadClick:{id:"closeup_download_button_trigger",evaluate:({limitReached:e,modal:n})=>!!(e&&!n?.isShown),getNextState:({action:e,state:n})=>({...n,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:`click_context_menu_${e.payload.attributionLabelSource}_download_button`,container:"download",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"downloadImageBtnUnauth",savePinId:e.payload.pinId}},clickCloseUpContextMenuDownloadButton:!0,pinId:e.payload.pinId??"",attributionLabel:e.payload.attributionLabelSource})},shouldShowSignupModalOnFollowButtonClick:{id:"followers_button_trigger",evaluate:({modal:e,clickFollowButton:n})=>!e?.isShown&&!n,getNextState:({action:e,state:n})=>({...n,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:e.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",container:e.payload.isContextualFollowEnabled?"follow":"",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:e.payload.isContextualFollowEnabled?"followButton":void 0}},clickFollowButton:!0})},shouldShowSignupModalOnFollowingButtonClick:{id:"following_button_trigger",evaluate:({modal:e,clickFollowingButton:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_following",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowingButton:!0})},shouldShowSignupModalOnFollowersButtonClick:{id:"followers_button_trigger",evaluate:({modal:e,clickFollowersButton:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"signup"},attributionLabel:"click_followers",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"}},clickFollowersButton:!0})},shouldShowLoginModalOnCommentComposerClick:{id:"comment_composer_trigger",evaluate:({modal:e,clickCommentComposerUpsell:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"tap_unauth_comment_composer",container:"closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP",source:"commentComposer"}},clickCommentComposerUpsell:!0})},shouldShowLoginModalOnRelatedPinOpenLinkClick:{id:"related_pin_open_link_trigger",evaluate:({modal:e,clickRelatedPinOpenLinkUpsell:n})=>!e?.isShown&&!n,getNextState:({state:e})=>({...e,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"click_context_menu_related_pin_right_click_open_link_button",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickRelatedPinOpenLinkUpsell:!0})},shouldShowLoginModalOnPinLinkClick:{id:"pin_link_trigger",evaluate:({modal:e,pinLinkClickCount:n=0})=>!e?.isShown&&(2===n||n%5==0),getNextState:({action:e,state:n})=>({...n,modal:{isShown:!0,displayProps:{signupFlow:{type:"login"},attributionLabel:"pinLinkClickHandler_tier1",container:"hybrid_clickthrough",reason:"UPSELL_LOGIN_OR_SIGNUP"}},clickPinLinkCount:e.payload.count})}},i={shouldAllowUnauthSave:{id:"mobile_unauth_save_quota_check",evaluate:({isPPMAndroidUnauthExperience:e,isFromUnauthContextMenu:n,currentUnauthSaves:a=0,mobileUnauthSaveThreshold:o})=>!n&&!e&&a<(o??2),getNextState:({action:e,state:n})=>({...n,mWebSignupModal:{...n.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(n.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:n.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:e.payload.headingType,trigger:{attributionLabel:"extended_save_out_of_quota"===e.payload.headingType?"click_save_button_with_max_unauth_saves":e.payload.attributionLabel||"click_save_button_on_closeup",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:e.payload.pinId}}})},shouldShowMainPinImageNavigationalModal:{id:"mobile_main_pin_image_modal",evaluate:({checkExperiment:e,isUpsellEnabledGlobally:n,isModalCurrentlyShown:a,learningUpsellScenario:o})=>!!(o&&n&&!a&&(e?.("mweb_unauth_main_learning_pin_full_page").anyEnabled||e?.("mweb_q2_mau_push_pc").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced_row").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency_row").anyEnabled||e?.("mweb_q2_mau_push_pc_eu").anyEnabled||e?.("mweb_q2_mau_push_pc_eu_safe").anyEnabled)),getNextState:({action:e,state:n})=>({...n,mWebSignupModal:{...n.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(n.mWebSignupModal?.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:n.mWebSignupModal.scrollControllerHasDisplayed,modal:{isShown:!0,displayProps:{headingType:"none",trigger:{attributionLabel:"navigation_main_pin_image_click",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0},pinId:e.payload.pinId}}})},shouldShowMainPinImageAppUpsell:{id:"mobile_main_pin_app_upsell_purple_banner",getNextState:({state:e})=>e,evaluate:({learningUpsellScenario:e,hasConversionUpsell:n,isLearningAppUpsellShown:a})=>n||!e?{shouldToggleAppUpsell:!1,currentlyShowing:!1,newState:!1}:{shouldToggleAppUpsell:!0,currentlyShowing:a,newState:!a}},shouldShowNavigationUpsell:{id:"mobile_navigation_upsell",evaluate:({checkExperiment:e,isUpsellEnabledGlobally:n,isModalCurrentlyShown:a,oldLocation:o,newLocation:t,isNavigationFromSwipe:l,currentNavigationCount:i,hasSeenModal:s,pageThreshold:u,isWashDismissible:_,canShowSignupModalOnRouteChange:r,canShowSignupModalOnRouteChangeControl:d,navigationalPagesViewThresholdMobile:p})=>{let c=p||u||4;return a?{shouldShowModal:!1,shouldDismissModal:!0,shouldIncrementCount:!1}:n&&!l&&(e?.("mweb_unauth_navigational_pages_upsell").anyEnabled?!!t&&r?.(t):!!t&&!!o&&d?.({newLocation:t,oldLocation:o}))?!((i??0)>=c)||s?{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!0}:{shouldShowModal:!0,shouldDismissModal:!1,shouldIncrementCount:!0,attributionLabel:`navigation_${c}_${i}`,allowCloseOnOutsideClick:_}:{shouldShowModal:!1,shouldDismissModal:!1,shouldIncrementCount:!1}},getNextState:({state:e,decision:n})=>({...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:"none",trigger:{attributionLabel:n?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!!n?.allowCloseOnOutsideClick},pinId:null}}})},shouldShowOnLandUpsell:{id:"mobile_on_land_upsell",evaluate:({checkExperiment:e,isUpsellEnabledGlobally:n,hasSeenNavUpsell:a,location:l,isPaid:i,isSocial:s,isDirect:u,isSEO:_,userAgent:r,unAuthMwebSocialPinLandingExpGroup:d,isSocialInAppBrowser:p})=>{if(!n||a||!(l&&((0,o.L6)(l)||(0,o.am)(l)||(0,t.Z)(l)||(0,o.En)(l)||(0,o.ey)(l))))return{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null};let c=e?.("mweb_on_land_full_page_signup_upsell").anyEnabled,S=_&&(e?.("mweb_seo_q2_upper_bound").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency_row").anyEnabled),m=u&&(e?.("mweb_direct_q2_upper_bound").anyEnabled||e?.("mweb_q2_mau_push_pc").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced_row").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency_row").anyEnabled||e?.("mweb_q2_mau_push_pc_eu").anyEnabled),g=i&&(e?.("mweb_paid_q2_upper_bound").anyEnabled||e?.("mweb_q2_mau_push_pc").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced").anyEnabled||e?.("mweb_q2_mau_push_pc_advanced_row").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency").anyEnabled||e?.("mweb_q2_mau_push_pc_emergency_row").anyEnabled||e?.("mweb_q2_mau_push_pc_eu").anyEnabled),h=s&&e?.("mweb_social_q2_upper_bound").anyEnabled,b=!(p?.(r)&&e?.("mweb_unauth_social_iab_upsell_boost_experiment",{dangerouslySkipActivation:!0}).anyEnabled)&&d?.startsWith("enabled"),w="enabled"===d;return c||S||m||g||h||b?{shouldShowModal:!0,shouldIncrementCount:!0,showUnauthMwebSocialUpsell:b,modalConfig:{reason:"UPSELL_LOGIN_OR_SIGNUP",attributionLabel:"navigation_0",navigationTriggeredUpsell:{newLocation:l,oldLocation:l},headingType:b?"social":"none",allowCloseOnOutsideClick:!(m||g||w)}}:{shouldShowModal:!1,shouldIncrementCount:!1,modalConfig:null}},getNextState:({state:e,decision:n})=>{let{modalConfig:a}=n;return{...e,mWebSignupModal:{...e.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(e.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:e.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:a?.headingType,trigger:{attributionLabel:a?.attributionLabel??"",reason:"UPSELL_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:a?.allowCloseOnOutsideClick??!1},pinId:null}}}}},shouldShowSignupModalOnContextMenuDownloadClick:{id:"mobile_context_menu_download_button_trigger",evaluate:({limitReached:e,inImmediateUpsellGroup:n,modal:a})=>(e||n)&&!a?.isShown,getNextState:({action:e,state:n})=>{let{inMwebDownloadCTAExp:a,showDownloadCloseupIcon:o,attributionLabelSource:t}=e.payload,l={trigger:{attributionLabel:`click_${t}_download_button`,reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},headingType:a||o?"download_limit_reached":"none"};return{...n,mWebSignupModal:{...n.mWebSignupModal,modal:{isShown:!0,displayProps:l,pinId:e.payload.pinId??""}}}}},shouldShowSignupModalOnFollowButtonClickMobile:{id:"follow_button_trigger_mobile",evaluate:({mWebSignupModal:e})=>!e?.modal.isShown,getNextState:({action:e,state:n})=>({...n,mWebSignupModal:{...n.mWebSignupModal,lastShownTime:Date.now(),timesShownForSessionCount:(n.mWebSignupModal.timesShownForSessionCount??0)+1,scrollControllerHasDisplayed:n.mWebSignupModal.scrollControllerHasDisplayed,modalHasShown:!0,modal:{isShown:!0,displayProps:{headingType:e.payload.isContextualFollowEnabled?"follow":"none",trigger:{attributionLabel:e.payload.isIdeaPin?"click_idea_pin_follow":"click_follow",reason:"ACTION_REQUIRES_LOGIN_OR_SIGNUP"},allowCloseOnOutsideClick:!0}}}})}},s={desktop:l,mobile:i}},153984:(e,n,a)=>{a.d(n,{HK:()=>w,$S:()=>y,by:()=>h,mX:()=>g,kd:()=>N,Pp:()=>I,P9:()=>L,rA:()=>C,Ik:()=>O,Bi:()=>E,sg:()=>H,wK:()=>W,Zr:()=>P,it:()=>v,Lu:()=>q,TQ:()=>B,tA:()=>k,V9:()=>R,jB:()=>$,Ue:()=>f,g_:()=>x,qs:()=>D,$y:()=>r,gH:()=>U,dn:()=>M,Bh:()=>G,f$:()=>F,OU:()=>d,Yr:()=>T,UA:()=>A,qT:()=>b,Gh:()=>m,K7:()=>S,AS:()=>c,ub:()=>K,pp:()=>p,LL:()=>ea,Hm:()=>en,QA:()=>J,WE:()=>ei,QG:()=>eo,G5:()=>z,b9:()=>ee,Jw:()=>eL,xY:()=>el,FV:()=>et,YT:()=>ew,tW:()=>es,F8:()=>eu,CC:()=>eI,C5:()=>X,qq:()=>ey,o9:()=>ed,Qm:()=>ec,Aw:()=>ep,t:()=>eE,Pu:()=>eh,CH:()=>em,aj:()=>eg,v2:()=>e_,BF:()=>Z,Li:()=>Y,Dk:()=>V,IS:()=>eb,vY:()=>Q,dL:()=>j,Ff:()=>er,yC:()=>eS});var o=a(892700),t=a(112800),l=a(955696),i=a(103787);let s=e=>{let{modal:n,mWebSignupModal:a,appUpsells:o}=e;return!!(n.isShown||a.modal.isShown||o.learningUpsell?.isShowing)};var u=a(178901),_=a(992114);let r="PROCESS_MOBILE_NAVIGATION_CHANGE",d="SET_UPSELL_REASON",p="UPS_EVENT_PIN_VIEW",c="UPS_EVENT_PIN_SAVE",S="UPS_EVENT_DESKTOP_MODAL_SHOW",m="UPS_EVENT_DESKTOP_MODAL_DISMISSED",g="CLICK_CLOSE_UP_CONTEXT_MENU_SAVE_BUTTON",h="CLICK_CLOSE_UP_CONTEXT_MENU_DOWNLOAD_BUTTON",b="TRIGGER_SCROLL_DOWN_UPSELL",w="CLEAR_SCROLL_DOWN_UPSELL",y="CLICK_CLOSEUP_UPSELL",L="CLICK_CONTEXT_MENU_SAVE_BUTTON_UPSELL",I="CLICK_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",E="CLICK_FOLLOW_BUTTON_UPSELL",O="CLICK_FOLLOWING_BUTTON_UPSELL",C="CLICK_FOLLOWERS_BUTTON_UPSELL",N="CLICK_COMMENT_COMPOSER_UPSELL",P="CLICK_PIN_LINK_UPSELL",v="CLICK_RELATED_PIN_OPEN_LINK_UPSELL",U="RECORD_NAVIGATIONAL_PAGE",M="RESET_UPSELL_TRIGGER_STATE",T="SHOW_MOBILE_SIGNUP_MODAL",k="DISMISS_MOBILE_SIGNUP_MODAL",f="INCREMENT_UPSELL_ELIGIBLE_NAVIGATION_COUNT",R="HIDE_UNAUTH_SHARING_MODALS",A="SHOW_UNAUTH_SHARING_MODALS",G="RESTORE_FROM_LOCAL_STORAGE",x="MAIN_PIN_IMAGE_CLICK_MOBILE",D="ON_LAND_UPSELL_MOBILE",F="SET_LEARNING_UPSELL_VISIBILITY",W="CLICK_MOBILE_CONTEXT_MENU_DOWNLOAD_BUTTON_UPSELL",B="DISMISS_MOBILE_FLOATING_UPSELL",H="CLICK_FOLLOW_BUTTON_UPSELL_MOBILE",$="INCREMENT_PIN_SAVE_COUNT",q="DECREMENT_PIN_SAVE_COUNT",K="UPS_EVENT_PIN_SAVE_MOBILE",V=e=>({type:G,payload:{upsellEligibleNavigationCount:e}}),Q=e=>({type:d,payload:{upsellReason:e}}),Y=(e,n)=>({type:p,payload:{pinId:e,seoUrl:n}}),Z=(e,n)=>({type:c,payload:{pinId:e,attributionLabel:n}}),X=()=>({type:m}),j=e=>({type:S,payload:{displayProps:e}}),J=()=>({type:y}),z=(e,n,a)=>({type:L,payload:{pinId:e,attributionLabelSource:n,signupToLoginExpGroup:a}}),ee=(e,n)=>({type:E,payload:{isIdeaPin:e,isContextualFollowEnabled:n}}),en=(e,n,a)=>({type:g,payload:{pinId:e,attributionLabelSource:n,signupToLoginExpGroup:a}}),ea=({pinId:e,attributionLabelSource:n,downloadAllowedCallback:a})=>({checkExperiment:o,sessionContext:l})=>(l,i)=>{let{limitReached:_,oldCount:r,newCount:d}=(0,u.H)(o);(0,t.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:n,limitReached:_,oldCount:r,newCount:d}),l({type:h,payload:{pinId:e,attributionLabelSource:n,limitReached:_,checkExperiment:o}}),s(i().upsell)||a()},eo=({pinId:e,attributionLabelSource:n,inImmediateUpsellGroup:a,inDwebSwapDownloadUpsellExp:o,downloadAllowedCallback:l,showDownloadIconForRelatedPins:i,inDwebDownloadCTAExp:_})=>({checkExperiment:r,sessionContext:d})=>(d,p)=>{let{limitReached:c,oldCount:S,newCount:m}=(0,u.H)(r);i?(0,t.My)("dweb.unauth.action_bar.download_image",{attributionLabelSource:n,limitReached:c,oldCount:S,newCount:m}):_?(0,t.My)("dweb.unauth.download_cta.download_image",{attributionLabelSource:n}):o?(0,t.My)("dweb.unauth.swap_download_upsell.download_image",{attributionLabelSource:n}):(0,t.My)("dweb.unauth.context_menu.download_image",{attributionLabelSource:n,limitReached:c,oldCount:S,newCount:m}),d({type:I,payload:{pinId:e,attributionLabelSource:n,limitReached:c,inImmediateUpsellGroup:a,inDwebSwapDownloadUpsellExp:o,checkExperiment:r}}),s(p().upsell)||l()},et=()=>({type:O}),el=()=>({type:C}),ei=()=>({type:N}),es=e=>({type:P,payload:{count:e}}),eu=()=>({type:v}),e_=(e,n)=>({type:U,payload:{pageUniqueKey:e,containerPage:n}}),er=e=>({type:T,payload:e}),ed=()=>({type:k}),ep=()=>({type:f}),ec=()=>({type:R}),eS=()=>({type:A}),em=e=>(n,a)=>{n({type:r,payload:{...e}}),s(a().upsell)||(0,t.My)(`mweb.nav.upsell.show.${e.currentNavigationCount}`)},eg=e=>({checkExperiment:n,sessionContext:a})=>(s,u)=>{let r=u().upsell,{country:d,userAgent:p}=a,c=i.YM.mobile.shouldShowOnLandUpsell?.evaluate({checkExperiment:n,isUpsellEnabledGlobally:(0,l.e_)({isModalShown:r.mWebSignupModal.modal.isShown??!1,isUnauthSharingModalsShown:r.mWebSignupModal.isUnauthSharingModalsShown??!1,modalHasShown:!!r.mWebSignupModal.modalHasShown,country:d,userAgent:p}),hasSeenNavUpsell:r.mWebSignupModal.modalHasShown,location:e.location,isPaid:e.isPaid,isSocial:e.isSocial,isDirect:e.isDirect,isSEO:e.isSEO,userAgent:p,unAuthMwebSocialPinLandingExpGroup:e.unAuthMwebSocialPinLandingExpGroup,isSocialInAppBrowser:o.ry});c.shouldShowModal&&c.modalConfig&&((0,t.My)("mweb.nav.upsell.show.0"),c.showUnauthMwebSocialUpsell&&(0,_.nP)("unauth.mweb.social.pin.upsell",{sampleRate:1,tags:{exp_group:e.unAuthMwebSocialPinLandingExpGroup}}),s({type:D,payload:{decision:c}}))},eh=e=>({checkExperiment:n,sessionContext:a})=>(a,o)=>{let l=o().upsell,s=!!l.appUpsells.learningUpsell?.isShowing,u=i.YM.mobile.shouldShowMainPinImageNavigationalModal?.evaluate({checkExperiment:n,isUpsellEnabledGlobally:e.upsellContext.isUpsellEnabledGlobally(),isModalCurrentlyShown:e.upsellContext.isModalShown,learningUpsellScenario:e.learningUpsellScenario}),_=i.YM.mobile.shouldShowMainPinImageAppUpsell?.evaluate({learningUpsellScenario:e.learningUpsellScenario,hasConversionUpsell:!!u,isLearningAppUpsellShown:s});u?(0,t.My)("mweb.nav.upsell.show.main_pin_image_click"):_.shouldToggleAppUpsell?_.currentlyShowing?e.trackInteraction({action:"dismiss",item:"learning-upsell"}):e.trackInteraction({action:"click",item:"learning-upsell"}):e.onImageClick(),a({type:x,payload:{conversionDecision:u,appUpsellDecision:_,pinId:e.pinId}})},eb=e=>({type:F,payload:{isShowing:e}}),ew=({pinId:e,attributionLabelSource:n,inImmediateUpsellGroup:a,inMwebDownloadCTAExp:o,showDownloadCloseupIcon:l,downloadAllowedCallback:i})=>({checkExperiment:_,sessionContext:r})=>(r,d)=>{let{limitReached:p,oldCount:c,newCount:S}=(0,u.H)(_);o?(0,t.My)("mweb.unauth.download_cta.download_image",{attributionLabelSource:n}):l?(0,t.My)("mweb.unauth.download_closeup_icon.download_image",{attributionLabelSource:n}):(0,t.My)("mweb.unauth.context_menu.download_image",{attributionLabelSource:n,limitReached:p,oldCount:c,newCount:S}),r({type:W,payload:{pinId:e,attributionLabelSource:n,limitReached:p,inImmediateUpsellGroup:a,inMwebDownloadCTAExp:o,showDownloadCloseupIcon:l,checkExperiment:_}}),s(d().upsell)||i()},ey=()=>({type:B}),eL=(e,n)=>({type:H,payload:{isIdeaPin:e,isContextualFollowEnabled:n}}),eI=()=>({type:q}),eE=e=>({checkExperiment:n,sessionContext:a})=>(a,o)=>{let t=o().upsell;i.YM.mobile.shouldAllowUnauthSave?.evaluate({checkExperiment:n,isPPMAndroidUnauthExperience:e.isPPMAndroidUnauthExperience,isFromUnauthContextMenu:e.isFromUnauthContextMenu,currentUnauthSaves:t.mWeb.pinSaveCount})&&!t.mWebSignupModal.modal.isShown?(e.unauthSavedPinsStore.save({id:e.pinId,nodeId:e.nodeId,imageUrl:e.getPinGifOrImageSrc({imagesUrls:e.imagesUrls,embedSrc:e.embedSrc,embedType:e.embedType,excludeOriginals:!e.isBot&&!e.isSocialBot})}),a({type:$}),e.setNumUnauthSavedPins(e.numUnauthSavedPins+1),e.handleShowNavFooter(a,e.forceShowNavFooter,e.isNavBarHidden,e.setForceShowNavFooter),e.successCallback&&e.successCallback()):a({type:K,payload:{attributionLabel:e.isFromUnauthContextMenu?e.attributionLabel||"click_save_button_on_closeup":"click_save_button_with_max_unauth_saves",headingType:e.isFromUnauthContextMenu?"save":"extended_save_out_of_quota",pinId:e.pinId}})}},541105:(e,n,a)=>{a.d(n,{A4:()=>s,T9:()=>u,qo:()=>i,y1:()=>l});var o=a(892700),t=a(339176);let l=e=>e?(0,t.Z)(e.toUpperCase()):"OTHER",i=e=>e.isPaid?"paid":e.isInvite?"invite":e.isSocial?"social":e.isSEO?"seo":e.utmSource?`utm_${e.utmSource}`:"direct",s=e=>e&&"string"==typeof e?(0,o.$K)(e)?"pinterest":(0,o.dh)(e)?"instagram":/wechat|micromessenger/i.test(e)?"wechat":(0,o.ry)(e)||/facebook|fbav|fban|tiktok|twitter|line/i.test(e)?"social":"none":"none",u=(e,n)=>{let a=e?.countryFromHostName||e?.country||"",o=e?.userAgent?.raw||("undefined"!=typeof navigator?navigator.userAgent:"");return{country:a,userAgent:o,referrer:e?.referrerFromHeader||e?.referrerFromCookie||"",unauthID:e?.unauthId||"",region:l(a),channel:i(n),iab:s(o)}}},839284:(e,n,a)=>{a.d(n,{Z:()=>s});var o=a(667294);let t=()=>()=>{},l=()=>!1,i=()=>!0,s=()=>(0,o.useSyncExternalStore)(t,l,i)},178901:(e,n,a)=>{a.d(n,{H:()=>s,Z:()=>i});var o=a(547504),t=a(943369),l=a(112800);async function i({filename:e,imgSrc:n,imageDownloadSuccessCallback:a,category:o,pinId:t,viewParameter:i,viewType:s,isUnauth:u=!1,platform:_="web",expName:r,expGroup:d},p){return"undefined"==typeof window?Promise.resolve():((0,l.My)("web.download.click",{category:o||"no_category",authType:u?"unauth":"auth",platform:_,viewType:s,expName:r,expGroup:d}),p({event_type:82,object_id_str:t,view_type:s||3,view_parameter:i||139}),n&&document)?fetch(n,{headers:new Headers({Origin:window.location.origin}),mode:"cors"}).then(e=>e.blob()).then(n=>{let t=document.createElement("a");t.href=window.URL.createObjectURL(n),t.setAttribute("download",e&&e.replace(".","_")),t.style.display="none",document.body?.appendChild(t),t.click(),document.body?.removeChild(t),(0,l.My)("web.download.success",{category:o||"no_category",authType:u?"unauth":"auth",platform:_,viewType:s,expName:r,expGroup:d}),a?.()}).catch(()=>{throw(0,l.My)("web.download.failure",{category:o||"no_category",authType:u?"unauth":"auth",platform:_,viewType:s,expName:r,expGroup:d}),Error("Download image error")}):Promise.resolve()}let s=e=>{let n=(0,t.M0)(),a=e("unuath_download_paywalled").anyEnabled||e("unauth_combined_download_exp").anyEnabled;if(!n.accessAllowed||a)return{limitReached:!0,oldCount:0,newCount:0};let l=n.getItem(o.rN)||0,i=l>=1,s=i?l:l+1;return l!==s&&(0,t.M0)().setItem(o.rN,s),{limitReached:i,oldCount:l,newCount:s}}},559825:(e,n,a)=>{a.d(n,{C:()=>i,P:()=>l});var o=a(890360),t=a(992114);let l=()=>!1,i=e=>{(0,o.LM)(e)&&!l()&&(0,t.nP)("mobile_signup_modal.rules.suppress_for_discover_article",{flushImmediate:!0,sampleRate:1})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/53984-a3bc2fb5fb012391.mjs.map